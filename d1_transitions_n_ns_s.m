function [nstart,nstart_VOT]=d1_transitions_n_ns_s(nenter,speed,t,matrix_demand_VOT)
% matrix=[0,0,0,20,0,30,0,0,0,0,0,0,0,0,0,0;0,0,0,20,0,30,0,0,0,0,0,0,0,0,0,0;0,0,0,20,0,30,1,1,0,0,0,1,0,0,0,0;1,0,0,20,1,30,2,2,0,0,0,3,1,0,0,0;2,1,0,20,3,30,2,2,1,0,0,5,3,1,0,0;2,2,1,19,4,30,3,3,2,0,0,8,5,3,0,0;3,2,3,17,5,30,5,5,2,0,0,13,8,5,0,0;5,3,5,15,8,30,6,6,3,0,0,19,13,8,0,0;6,5,8,12,11,30,6,6,5,0,0,25,19,13,0,0;6,6,13,7,12,30,7,7,5,1,0,32,25,18,1,0;8,7,17,3,15,30,8,8,3,1,1,40,32,21,2,1;9,11,19,1,20,30,8,8,1,1,1,48,40,22,3,2;9,18,19,1,27,30,9,9,1,1,1,57,48,23,4,3;10,25,19,1,35,30,9,9,1,2,1,66,57,24,6,4;11,33,18,2,44,30,9,9,2,2,2,75,66,26,8,6;11,40,18,2,51,30,9,9,2,2,2,84,75,28,10,8;11,47,18,2,58,30,9,9,2,2,2,93,84,30,12,10;11,54,18,2,65,26.1538461500000,8,9,2,2,2,101,93,32,14,12;10,61,18,2,71,22.2535211300000,8,8,2,2,2,109,102,34,16,14;9,68,18,2,77,18.9610389600000,8,8,2,2,2,117,110,36,18,16;9,74,18,2,83,16.1445783100000,7,8,2,2,2,124,118,38,20,18;8,80,18,2,88,14.0909090900000,7,7,2,2,2,131,126,40,22,20;7,86,18,2,93,12.2580645200000,7,0,2,2,2,138,133,42,24,22;7,91,18,2,98,10.6122449000000,6,7,2,2,0,144,133,44,26,22;15,89,18,2,104,8.84615384600000,6,7,2,2,2,150,140,46,28,24;14,94,18,2,108,7.77777777800000,5,0,2,2,2,155,147,48,30,26;12,99,18,2,111,7.02702702700000,5,6,2,2,0,160,147,50,32,26;19,97,18,2,116,5.86206896600000,4,0,2,2,2,164,153,52,34,28;17,101,18,2,118,5.42372881400000,4,6,2,2,0,168,153,54,36,28;23,99,18,2,122,4.59016393400000,4,5,2,2,2,172,159,56,38,30;21,103,18,2,124,4.19354838700000,3,0,2,2,2,175,164,58,40,32;19,106,18,2,125,4,3,5,2,2,0,178,164,60,42,32;24,104,18,2,128,3.43750000000000,3,0,2,2,2,181,169,62,44,34;22,107,18,2,129,3.25581395300000,2,4,2,2,0,183,169,64,46,34;26,105,18,2,131,2.90076335900000,2,0,2,2,2,185,173,66,48,36;24,107,18,2,131,2.90076335900000,2,4,2,2,0,187,173,68,50,36;28,105,18,2,133,2.55639097700000,2,0,2,2,2,189,177,70,52,38;26,107,18,2,133,2.55639097700000,1,4,2,2,0,190,177,72,54,38;29,105,18,2,134,2.38805970100000,1,0,2,2,2,191,181,74,56,40;26,107,18,2,133,2.55639097700000,1,3,2,2,0,192,181,76,58,40;29,105,18,2,134,2.38805970100000,1,0,2,2,2,193,184,78,60,42;27,106,18,2,133,2.55639097700000,1,3,2,2,0,194,184,80,62,42;30,104,18,2,134,2.38805970100000,1,0,2,2,2,195,187,82,64,44;28,105,18,2,133,2.55639097700000,1,3,2,2,0,196,187,84,66,44;31,103,18,2,134,2.38805970100000,1,2,2,2,2,197,190,86,68,46;29,104,18,2,133,2.55639097700000,1,2,2,2,2,198,192,88,70,48;28,104,18,2,132,2.72727272700000,0,2,2,2,2,198,194,90,72,50;26,104,18,2,130,3.07692307700000,0,2,2,2,2,198,196,92,74,52;24,104,18,2,128,3.43750000000000,0,1,2,2,2,198,198,94,76,54;22,104,18,2,126,3.80952381000000,0,199,2,2,2,198,199,96,78,56;];
% nenter=[0 0 1 2 2 3 5 6 6 7 8 8 9 9 9 9 9 8]';
% speed=[30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 26.1538461538462]';
% t=1/60;
%this is to find the number of vehicles start to search in time slice i+1;
%nenter has i rows, as well as speed.
%"nenter" is the vehicles entered the area in all the previous time slices, correspondingly "speed" is
%the average travel speed in that time slice.
%%% 
% nenter =[     0
%      0
%      1
%      2
%      2
%      3
%      5
%      6
%      6
%      7
%      8
%      8
%      9
%      9
%      9
%      9
%      9
%      8]
% 
% 
% speed =[
% 
%    30.0000
%    30.0000
%    30.0000
%    30.0000
%    30.0000
%    30.0000
%    30.0000
%    30.0000
%    30.0000
%    30.0000
%    30.0000
%    30.0000
%    30.0000
%    30.0000
%    30.0000
%    30.0000
%    30.0000
%    26.1538]
% 
% 
% t =    0.0167
% 
% matrix_demand_VOT = [ 0   0   0; 
%                       0   0   0;
%                       3   3   4
%                       6   6   8
%                       6   6   8
%                       9   9  12
%                       5  15  20
%                       8  18  24
%                       8  18  24
%                       10 21  28
%                       10 24  32
%                       10 24  32
%                       11 27  36
%                       11 27  36
%                       11 27  36
%                       11 27  36
%                       11 27  36
%                       11 24  32]
                         

% im Vergleich zu Modell: betrachte anstatt i i+1 und anstatt i-1 i (je
% eins nach oben im Vergleich zu Skript)

i = size(nenter,1);
distancetraveled = zeros(i,2);
nstart = 0;
V = size(matrix_demand_VOT,2);
nstart_VOT = zeros(V,1);
for j=1:i
    distancetraveled(j,1)=sum(speed(j:i,1))*t;
    distancetraveled(j,2)=sum(speed(j:i-1,1))*t;
        if and(distancetraveled(j,1)>=c4_input__l_ns_s, distancetraveled(j,2)<c4_input__l_ns_s)
        nstart      =   nstart + nenter(j,1)*(1-c2_input_beta);
%       Consider different VOT origins (nstart_VOT is (V x 1)-vector, matrix_demand_VOT is (i x V)-matrix) 
        nstart_VOT  =   nstart_VOT + matrix_demand_VOT(j,:)'*(1-c2_input_beta);
         
        %c4_input__l_ns_s+speed(i,1)*t
        end
end

% nstart
% nstart_VOT
end
function nleave=d4_transitions_n_ns_leave(nenter, ndepart, speed, t)
% nenter=[6;6;7;8;8;9;9;9;9;9;8;8;8;7;7;7;6;6;5;5;4;4;4;3;3;3;2;2;2;2;1;1;1;1;1;1;1;1;1;0;0;0;0;0;0;0;0;0;0;0;0;];
% ndepart=[0;0;1;1;1;1;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;];
% speed=[30;30;30;30;30;30;30;30;30;30;30;30;30;30;30;30;26.1538461538462;22.2535211267606;18.9610389610390;16.1445783132530;14.0909090909091;12.2580645161290;10.6122448979592;8.84615384615385;7.77777777777778;7.02702702702703;5.86206896551724;5.42372881355932;4.59016393442623;4.19354838709678;4.00000000000000;3.43750000000000;3.25581395348837;2.90076335877862;2.90076335877862;2.55639097744361;2.55639097744361;2.38805970149254;2.55639097744361;2.38805970149254;2.55639097744361;2.38805970149254;2.55639097744361;2.38805970149254;2.55639097744361;2.72727272727273;3.07692307692308;3.43750000000000;];
% t=1/60;
[a b]=size(nenter);
nleave=0;
for i=1:a
    distancetraveled(i,1)=sum(speed(i:a,1))*t;
    distancetraveled(i,2)=sum(speed(i:a-1,1))*t;
    if and(distancetraveled(i,1)>=c5_input__l_throughtraffic_leave,distancetraveled(i,2)<c5_input__l_throughtraffic_leave)
        nleave=nleave+nenter(i,1)*(c2_input_beta);
    end
    if and(distancetraveled(i,1)>=c6_input__l_p_leave,distancetraveled(i,2)<c6_input__l_p_leave)
        nleave=nleave+ndepart(i,1);
    end
end

end